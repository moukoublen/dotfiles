#!/usr/bin/env bash

READ_ONLY=""
USR=""
args=()
while (($#)); do
  case "${1}" in
    -R|--RO)
      READ_ONLY=":ro"
      shift
      ;;
    --ME)
      USR="--user=$(id -u):$(id -g)"
      shift
      ;;
    *)
      args+=("${1}")
      shift
      ;;
  esac
done

FOLDER="/PORTAL/$(basename "${PWD}")"

set -x

exec docker run --rm --interactive --tty ${USR} --volume "${PWD}:${FOLDER}${READ_ONLY}" --workdir "${FOLDER}" "${args[@]}"
